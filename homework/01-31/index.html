<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>D3 and Javascript Libraries</title>
        <link rel="stylesheet" href="styles.css">
        <script src="/homework/01-31/scripts/myFunctions.js"></script>
        <script src="https://d3js.org/d3.v7.min.js"></script> <!--loads D3 library-->
    </head>

    <body>
        <div>
            <h1 id="HL">
                JS Libraries,<br>
                D3.js and Data Manipulation
            </h1>
        </div>

        <!--
        <p>This is an illustration of</p>
        <p>the D3 function</p>
        <p>.selectALL for chnging multiple elements</p>
        -->
        
        <script>
            var sm = sumAB(2,5);
            console.log(sm);
        </script>

        <div>
            <svg width="760" height="200" id="">
                <rect width="760" height="200" style="fill:white; stroke-width:1; stroke:black"/>
                
                <!--<circle/>
                <circle cx = "120"/>
                <circle cx = "240"/>
                <circle cx = "360"/>
                <circle cx = "480"/>-->

            </svg>
        </div>

        <script>
            var page_title = d3.select("#HL");
            page_title.style("color", "blue");     //(attribute, value)
            page_title.style("font-size", "60px");

            // chaining together multiple attribute-value pairs
            page_title.style("color", "green")
                .style("background-color", "pink")
                .style("font-size", "50px");

            // changing element attributes: Assign new class to H1 tag
            page_title.attr("class", "comicText");

            // changing multiple element sytles or multiple attributes
            // .selectALL tells D3 to go to the HTML file and select all elements with the p tag
            //useful when manipulating SVG elements
            d3.selectAll("p").style("text-align","center")
                .attr("class", "comicText");
            
            // d3.selectAll("p").style("margin-top", "80px");
            
            // using d3.selectAll() for multiple simultaneous selections
            var allCircles = d3.selectAll("circle")
                .style("fill", "green")
                .attr("cy", "50")
                .attr("r", "30");

        </script>

        <div>
            <svg id="data-viz">

            </svg>
        </div>

        <div>
            <button onClick="drawCircles(data1)">Data 1</button>
            <button onClick="drawCircles(data2)">Data 2</button>
            <button onClick="drawCircles(data3)">Data 3</button>
        </div>

        <script>
            // Data array 1
            var data1 = [
                {
                    country: "usa",
                    value: 12412341
                },
                {
                    country:"mex",
                    value: 24318650
                }
            ];
            
            var data2 = [
                {
                    country: "chn",
                    value:"65430234"
                },
                {
                    country: "mex",
                    value:"24318650"
                }
            ];

            var data3 = [
                {
                    country: "chn",
                    value:"65430234"
                },
                {
                    country: "mex",
                    value:"24318650"
                },
                {
                    country: "usa",
                    value: 12412340
                }
            ];
            
            // This creates the random starting positions
            function randomPosition(){
                return Math.random() * 140 + 70;
            }

            // Function that draws circles using data arrays
            function drawCircles(dataArray) {
                var circles = d3.select("#data-viz").selectAll("circle")
                    .data(dataArray, function(d){
                        return d.country;
                    }); 

                //Enterting circles
                circles.enter().append("circle")
                    .fill("fill", function(d){
                        if d.country == "usa"){
                            return "blue";
                        } else if (d.country == "mex"){
                            return "green";
                        } else if (d.country == "chn"){
                            return "red";
                        }
                    })
                    .att("id", function(d){
                        return d.country;
                    })
                    .attr("cy", "100")
                    .attr("cx", randomPosition)
                    .attr("r", "0")
                    .transition().duration(1000)
                    .attr("r","25")

                //Updating circles
                circles.transition().duration(1000)
                    .attr("cx", randomPosition);
                
                //Exiting circles
                circles.exit()
                    .transition().duration(1000)
                    .attr("r", "0")
                    .remove();
            }

        </script>
    </body>
</html>